---
title: "Walking distance map"
author: "Jamie Hudson"
date: "2021-11-05"
output: html_document
tags: [data visualizations, ggplot2, rstats]
categories: [data visualizations, rstats]

image:
  caption: ""
  focal_point: ""
  preview_only: true
  
toc: false
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index_files/twitter-widget/widgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/jquery/jquery.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/leaflet/leaflet.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/leaflet/leaflet.js"></script>
<link href="{{< blogdown/postref >}}index_files/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/proj4/proj4.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/Proj4Leaflet/proj4leaflet.js"></script>
<link href="{{< blogdown/postref >}}index_files/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/leaflet-binding/leaflet.js"></script>
<script src="{{< blogdown/postref >}}index_files/leaflet-providers/leaflet-providers_1.9.0.js"></script>
<script src="{{< blogdown/postref >}}index_files/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
<script src="{{< blogdown/postref >}}index_files/clipboard/setClipboardText.js"></script>
<link href="{{< blogdown/postref >}}index_files/mapviewCSS/mapview-popup.css" rel="stylesheet" />
<link href="{{< blogdown/postref >}}index_files/mapviewCSS/mapview.css" rel="stylesheet" />


<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
<p>Unfortunately I have yet to find time to partake in the brilliant <a href="https://github.com/tjukanovt/30DayMapChallenge">#30DayMapChallenge</a>, an online challenge created by <a href="https://twitter.com/tjukanov">Topi Tjukanov</a>, where participants aim to create a map based on a specific daily theme throughout November.</p>
<p>One of my favourite parts of such a challenge is seeing wonderful maps produced using a variety of different tools ranging such as QGIS, Mapshaper, and (of course) <strong>R</strong>.</p>
<p>One map that jumped out to me, and that I keep going back to, is this brilliant submission by <a href="https://twitter.com/MRuehringer">Maria Ruehringer</a> for Day 2: Lines.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Day 2: Lines of <a href="https://twitter.com/hashtag/30DayMapChallenge?src=hash&amp;ref_src=twsrc%5Etfw">#30DayMapChallenge</a><br><br>Walking distance in minutes from <a href="https://twitter.com/hashtag/Amsterdam?src=hash&amp;ref_src=twsrc%5Etfw">#Amsterdam</a> Central Station<br><br>Tool: <a href="https://twitter.com/hashtag/QGIS?src=hash&amp;ref_src=twsrc%5Etfw">#QGIS</a>, <a href="https://twitter.com/hashtag/Inkscape?src=hash&amp;ref_src=twsrc%5Etfw">#Inkscape</a><br>Source: OpenStreetMap<a href="https://twitter.com/hashtag/gischat?src=hash&amp;ref_src=twsrc%5Etfw">#gischat</a> <a href="https://t.co/L8kQ5W9JM2">pic.twitter.com/L8kQ5W9JM2</a></p>&mdash; Maria Ruehringer (@MRuehringer) <a href="https://twitter.com/MRuehringer/status/1455453832666886144?ref_src=twsrc%5Etfw">November 2, 2021</a></blockquote>

<p>Maria has used QGIS and Inkscape to produce this lovely map of Amsterdam, with the colour of each street mapped to walking distance from Amsterdam Central Station, using OpenStreetMap data.</p>
<p>I thought I would try to recreate a similar plot using R, and use this as an opportunity to create a tutorial for such plots. For this, I will be using Battersea as our area of interest, Clapham Junction Station specifically, as this is the station I use to commute between London and Southampton.</p>
<p><em>I have no doubt that this tutorial will not be the most efficient way of producing such plots, if anyone has any tips on improving the code please feel free to contact me.</em></p>
</div>
<div id="tutorial" class="section level2">
<h2>Tutorial</h2>
<p>Firstly, let’s start with obtaining the walking distance data we will be using. For this, we will be using the R library <code>openrouteservice</code>, which enables us to obtain free geographic data from <a href="http://www.openstreetmap.org/">OpenStreetMap</a> through the <strong>openrouteservice API</strong>. We will also briefly use the <code>mapview</code> package.</p>
<p>After reading the Open Route Service (ORS) <a href="https://openrouteservice.org/terms-of-service/">terms and conditions</a>, we can install and load the packages:</p>
<pre class="r"><code>remotes::install_github(&quot;GIScience/openrouteservice-r&quot;)
library(openrouteservice)
library(mapview)</code></pre>
<p>Before we can use the ORS data we need to get a free personal API key, which we get by <a href="https://openrouteservice.org/dev/#/signup">signing up</a>. The <a href="https://giscience.github.io/openrouteservice-r/articles/openrouteservice.html">openrouteservice intro here</a> explains this step in more detail, but ends with us using the <a href="https://giscience.github.io/openrouteservice-r/reference/ors_api_key.html"><code>ors_api_key()</code></a> function to store the key.</p>
<pre class="r"><code>ors_api_key(&quot;&lt;your-api-key&gt;&quot;)</code></pre>
<p>What we are interested in are isochrones: areas of equal travel time from a starting point. To obtain the isochrones, we first need the coordinates of our starting location (in this case, Clapham Junction station)</p>
<pre class="r"><code>coordinates &lt;- data.frame(lon = c(-0.171201), lat = c(51.464290))</code></pre>
<p>and then we can use the function <a href="https://giscience.github.io/openrouteservice-r/reference/ors_isochrones.html"><code>ors_isochrones()</code></a> to store the isochrones as an <code>sf</code> (simple features) object.</p>
<pre class="r"><code>cj_iso &lt;- ors_isochrones(locations = coordinates, profile = &quot;foot-walking&quot;, range = 3600, interval = 600, output = &quot;sf&quot;)</code></pre>
<p>The arguments we have used are:</p>
<ul>
<li><code>locations</code>: where we specify the coordinate of our site of interest.</li>
<li><code>profile</code>: where we set our “route profile” which is basically our method of transport.
<ul>
<li>Options include transport via car, bike, and wheelchair amongst others (a full list can be obtained with the function <a href="https://giscience.github.io/openrouteservice-r/reference/ors_profile.html"><code>ors_profile()</code></a>)</li>
</ul></li>
<li><code>range</code>: The maximum value for our analyses in seconds (or meters if we wanted to do distance- but let’s stick with time).</li>
<li><code>interval</code>: The interval of our isochrones in seconds (i.e if you wanted an isochrone for every hour, this value would be 60 seconds x 60 minutes = 3600).</li>
<li><code>output</code>: the format of our output.</li>
</ul>
<p>Now we just need to tidy up our <code>sf</code> object a bit. We can split the <code>sf</code> file into a list of each time interval (which we convert into a factor), reorder this list from largest to smallest isochrone, and rename the isochrones to something more intuitive (i.e. minutes).</p>
<p>We can use the <code>mapview()</code> function to view a leaflet map to visualise the isochrones. This is useful to make a note of the approximate maximum/minimum latitude and longitude for our final map.</p>
<pre class="r"><code>mapviewOptions(fgb = FALSE)

intervals &lt;- levels(factor(cj_iso$value))
cj_iso_list_1 &lt;- split(cj_iso, intervals)
cj_iso_list &lt;- cj_iso_list_1[rev(intervals)]

names(cj_iso_list) &lt;- sprintf(&quot;%s_min&quot;, as.numeric(names(cj_iso_list))/60)

mapview(cj_iso_list, alpha.regions = 0.2, homebutton = FALSE, legend = FALSE)</code></pre>
<div id="htmlwidget-1" style="width:80%;height:560px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[-0.234057,-0.233821,-0.233761,-0.23311,-0.233123,-0.233082,-0.233016,-0.232058,-0.231445,-0.231444,-0.231333,-0.227857,-0.225496,-0.220553,-0.219554,-0.217355,-0.213504,-0.213209,-0.20787,-0.207374,-0.207525,-0.207313,-0.203517,-0.199961,-0.194969,-0.190555,-0.190398,-0.186526,-0.184004,-0.183675,-0.178798,-0.178561,-0.176089,-0.170666,-0.170462,-0.169999,-0.165095,-0.160177,-0.157594,-0.152783,-0.152427,-0.149738,-0.145733,-0.145271,-0.139778,-0.138364,-0.135692,-0.135577,-0.13502,-0.134431,-0.132017,-0.127222,-0.126578,-0.125478,-0.122017,-0.119792,-0.117606,-0.117451,-0.115712,-0.115535,-0.116324,-0.116412,-0.113971,-0.112158,-0.111205,-0.109067,-0.107964,-0.107903,-0.109599,-0.110309,-0.110575,-0.110753,-0.110823,-0.111791,-0.113678,-0.117957,-0.118565,-0.119906,-0.122888,-0.123245,-0.125974,-0.127708,-0.129996,-0.134705,-0.13589,-0.137364,-0.137411,-0.138303,-0.140191,-0.141551,-0.145369,-0.145663,-0.148894,-0.149514,-0.150214,-0.151473,-0.156778,-0.162569,-0.165537,-0.167911,-0.169383,-0.174227,-0.17963,-0.179805,-0.184068,-0.185218,-0.189462,-0.191308,-0.192191,-0.193266,-0.197676,-0.19912,-0.203783,-0.206336,-0.206651,-0.206958,-0.208893,-0.213171,-0.216057,-0.216557,-0.216587,-0.218817,-0.220189,-0.225744,-0.226027,-0.227873,-0.229828,-0.230295,-0.231208,-0.233975,-0.234057],"lat":[51.463985,51.45883,51.458475,51.456032,51.451934,51.451858,51.451747,51.450325,51.445235,51.445122,51.44478,51.443465,51.442352,51.439748,51.438945,51.437223,51.434966,51.435171,51.437441,51.432551,51.432361,51.43207,51.428932,51.429291,51.427461,51.426241,51.426208,51.42567,51.425249,51.425196,51.425643,51.425914,51.427816,51.425528,51.425434,51.42522,51.425484,51.425883,51.42597,51.426224,51.426274,51.427374,51.428478,51.428595,51.429794,51.430249,51.431377,51.431493,51.432086,51.432993,51.435902,51.437587,51.437704,51.438238,51.440583,51.440749,51.441312,51.441368,51.442362,51.442675,51.444831,51.448683,51.453148,51.455123,51.456788,51.460869,51.462746,51.46293,51.46745,51.470908,51.473628,51.476823,51.477176,51.478682,51.480831,51.484648,51.485409,51.486502,51.48871,51.488753,51.489072,51.487994,51.485995,51.48899,51.489792,51.491154,51.491204,51.492113,51.492338,51.49269,51.495549,51.495756,51.496204,51.496202,51.496214,51.49625,51.497352,51.498339,51.498829,51.498997,51.499069,51.499125,51.499531,51.499545,51.498897,51.498243,51.496009,51.495571,51.495445,51.494877,51.492278,51.492208,51.490345,51.490226,51.490052,51.489645,51.487274,51.484863,51.48364,51.483455,51.483348,51.479059,51.476852,51.474954,51.474732,51.470963,51.469711,51.469535,51.468965,51.464335,51.463985]}]]],null,"60_min",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.2,"smoothFactor":1,"noClip":false},"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>group_index&emsp;<\/th><td>0&emsp;<\/td><\/tr><tr><td>2<\/td><th>value&emsp;<\/th><td>3600&emsp;<\/td><\/tr><tr><td>3<\/td><th>center&emsp;<\/th><td>list&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"6",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.28,"bringToFront":false,"sendToBack":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addPolygons","args":[[[[{"lng":[-0.222456,-0.222148,-0.221249,-0.221853,-0.221794,-0.221346,-0.221193,-0.221094,-0.221033,-0.22095,-0.218283,-0.215074,-0.211962,-0.210753,-0.209699,-0.20952,-0.209422,-0.204997,-0.204512,-0.199729,-0.196835,-0.19283,-0.190885,-0.186525,-0.18469,-0.183859,-0.182188,-0.178619,-0.177586,-0.17291,-0.167569,-0.16399,-0.158865,-0.153851,-0.148653,-0.144796,-0.141061,-0.140749,-0.138413,-0.138092,-0.133113,-0.132997,-0.132715,-0.127598,-0.126696,-0.126442,-0.126297,-0.126341,-0.126419,-0.126458,-0.125642,-0.12363,-0.123015,-0.119677,-0.119216,-0.119221,-0.119309,-0.12034,-0.120662,-0.120485,-0.1205,-0.122951,-0.124715,-0.126715,-0.127379,-0.127563,-0.133352,-0.134113,-0.134249,-0.13637,-0.140405,-0.143226,-0.144784,-0.145215,-0.145547,-0.149366,-0.150717,-0.154646,-0.155225,-0.156845,-0.161281,-0.164894,-0.168266,-0.17237,-0.174873,-0.178459,-0.18377,-0.185766,-0.190244,-0.190549,-0.191174,-0.191425,-0.19158,-0.192047,-0.197055,-0.201016,-0.205704,-0.209789,-0.21004,-0.210773,-0.21272,-0.215886,-0.218442,-0.219461,-0.220272,-0.222335,-0.222456],"lat":[51.462249,51.459576,51.455873,51.452449,51.451737,51.44937,51.449045,51.448905,51.448844,51.448824,51.448452,51.447402,51.444484,51.443157,51.442025,51.441849,51.441795,51.438754,51.438292,51.435573,51.434908,51.433385,51.432309,51.432365,51.431931,51.43205,51.432818,51.433903,51.434162,51.434299,51.432139,51.43173,51.43184,51.432707,51.435434,51.436068,51.438085,51.438264,51.439946,51.440365,51.443086,51.443118,51.443342,51.445744,51.445872,51.445898,51.446227,51.446921,51.447559,51.447711,51.45203,51.453694,51.454092,51.458931,51.460095,51.463132,51.463481,51.467946,51.470836,51.474491,51.474851,51.477445,51.479554,51.481647,51.482166,51.482098,51.483376,51.483512,51.483477,51.482787,51.484287,51.48551,51.486197,51.486383,51.486523,51.48819,51.488784,51.490334,51.490463,51.490444,51.49104,51.491914,51.492734,51.492756,51.492524,51.49225,51.492224,51.4909,51.487051,51.487089,51.487071,51.486814,51.486613,51.486007,51.483858,51.483758,51.480845,51.477302,51.477044,51.475919,51.472733,51.469818,51.468565,51.467524,51.466301,51.462588,51.462249]}]]],null,"50_min",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.2,"smoothFactor":1,"noClip":false},"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>group_index&emsp;<\/th><td>0&emsp;<\/td><\/tr><tr><td>2<\/td><th>value&emsp;<\/th><td>3000&emsp;<\/td><\/tr><tr><td>3<\/td><th>center&emsp;<\/th><td>list&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"5",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.28,"bringToFront":false,"sendToBack":false}]},{"method":"addPolygons","args":[[[[{"lng":[-0.211678,-0.211537,-0.211457,-0.207234,-0.205342,-0.203933,-0.202972,-0.202689,-0.200243,-0.197808,-0.194949,-0.19308,-0.19198,-0.190999,-0.186971,-0.186611,-0.181319,-0.18002,-0.176677,-0.175803,-0.170335,-0.169247,-0.168241,-0.162378,-0.157103,-0.154266,-0.14983,-0.149138,-0.148516,-0.146456,-0.143339,-0.140584,-0.13919,-0.138196,-0.137449,-0.137177,-0.136194,-0.134516,-0.133128,-0.131118,-0.13056,-0.1299,-0.130355,-0.131682,-0.131752,-0.131922,-0.132553,-0.135263,-0.136083,-0.139893,-0.143269,-0.143422,-0.147646,-0.151453,-0.152201,-0.15399,-0.155427,-0.161107,-0.163042,-0.166278,-0.169318,-0.169401,-0.173482,-0.177235,-0.177474,-0.178312,-0.179857,-0.183663,-0.185452,-0.187398,-0.1876,-0.192873,-0.195209,-0.195524,-0.198426,-0.20118,-0.204231,-0.204188,-0.207696,-0.208956,-0.209868,-0.209977,-0.211387,-0.211678],"lat":[51.453873,51.453542,51.453504,51.451634,51.44991,51.44866,51.447761,51.447538,51.446959,51.445686,51.441133,51.440343,51.439921,51.439684,51.439026,51.439042,51.440542,51.440507,51.439833,51.439599,51.438567,51.438407,51.438318,51.437607,51.439826,51.441231,51.442777,51.44317,51.443574,51.445852,51.447938,51.448663,51.448872,51.449123,51.449305,51.449455,51.450612,51.454303,51.456655,51.459439,51.464532,51.469265,51.471492,51.475099,51.475138,51.475151,51.475091,51.474942,51.474883,51.474787,51.478915,51.47924,51.480314,51.48308,51.483144,51.482828,51.482675,51.484181,51.485098,51.485821,51.486479,51.486481,51.485905,51.486108,51.485838,51.484332,51.482286,51.481258,51.481444,51.480641,51.480343,51.478158,51.478219,51.478044,51.475453,51.474253,51.470385,51.470028,51.465498,51.465815,51.464221,51.463878,51.459385,51.453873]}]]],null,"40_min",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.2,"smoothFactor":1,"noClip":false},"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>group_index&emsp;<\/th><td>0&emsp;<\/td><\/tr><tr><td>2<\/td><th>value&emsp;<\/th><td>2400&emsp;<\/td><\/tr><tr><td>3<\/td><th>center&emsp;<\/th><td>list&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"4",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.28,"bringToFront":false,"sendToBack":false}]},{"method":"addPolygons","args":[[[[{"lng":[-0.200796,-0.200759,-0.200014,-0.197322,-0.193503,-0.190925,-0.187211,-0.186058,-0.18576,-0.185632,-0.184911,-0.184777,-0.184463,-0.17877,-0.174458,-0.1724,-0.168337,-0.165076,-0.161716,-0.160598,-0.155998,-0.155039,-0.154745,-0.153885,-0.153594,-0.151164,-0.147585,-0.147361,-0.145605,-0.143736,-0.141104,-0.141067,-0.141064,-0.141159,-0.140287,-0.139962,-0.140271,-0.140415,-0.142267,-0.143487,-0.148018,-0.153579,-0.154576,-0.155454,-0.158546,-0.158574,-0.15886,-0.161779,-0.164281,-0.166951,-0.172457,-0.172766,-0.173076,-0.173463,-0.173832,-0.174133,-0.174416,-0.174654,-0.17488,-0.175071,-0.180131,-0.180558,-0.181253,-0.18145,-0.181626,-0.186122,-0.187295,-0.18821,-0.190215,-0.191111,-0.191464,-0.1929,-0.193164,-0.194852,-0.195065,-0.196588,-0.199466,-0.200796],"lat":[51.456981,51.456623,51.455677,51.453468,51.451282,51.450236,51.446895,51.445503,51.445335,51.445482,51.446559,51.446708,51.447059,51.446123,51.445494,51.445076,51.444234,51.445028,51.445095,51.44506,51.448684,51.449215,51.449424,51.450112,51.450324,51.451928,51.452816,51.452862,51.45361,51.455702,51.460927,51.461006,51.461366,51.46186,51.467584,51.468453,51.46973,51.47006,51.47088,51.471267,51.474009,51.474964,51.475515,51.475954,51.477737,51.477753,51.477912,51.478765,51.479405,51.479651,51.480069,51.479927,51.479784,51.47955,51.479326,51.479092,51.47887,51.478646,51.478433,51.478209,51.47557,51.475546,51.475156,51.474855,51.474145,51.470465,51.470631,51.470797,51.47111,51.471247,51.471175,51.470405,51.470161,51.468175,51.467885,51.465616,51.462118,51.456981]}]]],null,"30_min",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.2,"smoothFactor":1,"noClip":false},"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>group_index&emsp;<\/th><td>0&emsp;<\/td><\/tr><tr><td>2<\/td><th>value&emsp;<\/th><td>1800&emsp;<\/td><\/tr><tr><td>3<\/td><th>center&emsp;<\/th><td>list&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"3",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.28,"bringToFront":false,"sendToBack":false}]},{"method":"addPolygons","args":[[[[{"lng":[-0.189913,-0.189218,-0.189144,-0.186657,-0.184993,-0.18031,-0.180053,-0.175638,-0.17326,-0.167612,-0.167253,-0.166285,-0.162832,-0.162125,-0.161834,-0.158107,-0.155333,-0.155125,-0.153769,-0.153118,-0.150667,-0.150691,-0.152108,-0.156475,-0.156833,-0.157373,-0.162528,-0.164604,-0.165411,-0.168689,-0.171819,-0.173478,-0.173824,-0.173934,-0.177169,-0.181276,-0.181607,-0.182099,-0.182262,-0.182385,-0.187302,-0.187561,-0.189294,-0.189913],"lat":[51.461733,51.457114,51.456762,51.455899,51.455517,51.451822,51.45157,51.451542,51.452704,51.451646,51.451615,51.451777,51.452579,51.452944,51.453155,51.456673,51.457961,51.458029,51.459013,51.460897,51.466112,51.466472,51.467379,51.469575,51.469527,51.469463,51.471683,51.472364,51.472552,51.473093,51.474014,51.473944,51.473847,51.473812,51.472087,51.469688,51.469213,51.468529,51.468314,51.46799,51.464839,51.464589,51.462651,51.461733]}]]],null,"20_min",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.2,"smoothFactor":1,"noClip":false},"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>group_index&emsp;<\/th><td>0&emsp;<\/td><\/tr><tr><td>2<\/td><th>value&emsp;<\/th><td>1200&emsp;<\/td><\/tr><tr><td>3<\/td><th>center&emsp;<\/th><td>list&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"2",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.28,"bringToFront":false,"sendToBack":false}]},{"method":"addPolygons","args":[[[[{"lng":[-0.178459,-0.178276,-0.178191,-0.176864,-0.174507,-0.173945,-0.170805,-0.166664,-0.166324,-0.165158,-0.162825,-0.162238,-0.162273,-0.162611,-0.167833,-0.169243,-0.17015,-0.17378,-0.177125,-0.177674,-0.178459],"lat":[51.462525,51.460179,51.459829,51.459285,51.458536,51.458441,51.458599,51.459589,51.459708,51.460702,51.463029,51.464292,51.46465,51.464829,51.466893,51.467127,51.467214,51.465758,51.464444,51.463757,51.462525]}]]],null,"10_min",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.2,"smoothFactor":1,"noClip":false},"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>group_index&emsp;<\/th><td>0&emsp;<\/td><\/tr><tr><td>2<\/td><th>value&emsp;<\/th><td>600&emsp;<\/td><\/tr><tr><td>3<\/td><th>center&emsp;<\/th><td>list&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.28,"bringToFront":false,"sendToBack":false}]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],["60_min","50_min","40_min","30_min","20_min","10_min"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addHomeButton","args":[-0.234057,51.425196,-0.107903,51.499545,true,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]},{"method":"hideGroup","args":[null]}],"limits":{"lat":[51.425196,51.499545],"lng":[-0.234057,-0.107903]},"fitBounds":[51.425196,-0.234057,51.499545,-0.107903,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
